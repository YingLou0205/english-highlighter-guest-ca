(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[696],{6465:function(e,t,s){Promise.resolve().then(s.bind(s,4985))},4985:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return i}});var a=s(7437),l=s(2265),n=s(8439);function i(){let e=l.useMemo(()=>(0,n.eI)("https://jjbsscygzuomnsfpzzex.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpqYnNzY3lnenVvbW5zZnB6emV4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYwMzQzMDksImV4cCI6MjA3MTYxMDMwOX0.kd3D0KsN0iekbJ9uPTEuQ0BTxAvopleychGiQ99ytsk"),[]),[t,s]=l.useState(!1),[i,r]=l.useState(null),[o,c]=l.useState(""),[u,d]=l.useState(""),[m,h]=l.useState(!1),[p,f]=l.useState(null),[x,b]=l.useState(null);l.useEffect(()=>{let t=!1;return(async()=>{var a,l;try{let s=(await e.auth.getSession()).data.session;if(!s){let{data:t,error:l}=await e.auth.signInAnonymously();if(l)throw l;s=null!==(a=t.session)&&void 0!==a?a:null}let l=null==s?void 0:s.user;if(!l)throw Error("Unable to establish a session");if(t)return;r(l.id),await e.from("profiles").upsert({id:l.id})}catch(e){t||b(null!==(l=null==e?void 0:e.message)&&void 0!==l?l:"Auth failed")}finally{t||s(!0)}})(),()=>{t=!0}},[e]);let y=async()=>{if(i){h(!0),f(null),b(null);try{let t={title:o.trim()||"Untitled",content:u,created_by:i},{data:s,error:a}=await e.from("documents").insert(t).select("id, short_code").single();if(a)throw a;let l=u.split(/\n\s*\n/g).map(e=>e.trim()).filter(e=>e.length>0);if(l.length){let t=l.map((e,t)=>({document_id:s.id,idx:t,text:e})),{error:a}=await e.from("paragraphs").insert(t);if(a)throw a}f("Created ✓ (code: ".concat(s.short_code,")")),c(""),d("")}catch(e){var t;b(null!==(t=null==e?void 0:e.message)&&void 0!==t?t:"Create failed")}finally{h(!1)}}};return(0,a.jsxs)("main",{className:"mx-auto max-w-3xl p-6 space-y-4",children:[(0,a.jsx)("h1",{className:"text-2xl font-semibold",children:"Create Document"}),(0,a.jsxs)("label",{className:"block space-y-2",children:[(0,a.jsx)("span",{className:"text-sm text-slate-600",children:"Title"}),(0,a.jsx)(e=>(0,a.jsx)("input",{...e,className:["w-full rounded border border-slate-300 px-3 py-2","outline-none focus:border-slate-500",e.className||""].join(" ")}),{placeholder:"Document title",value:o,onChange:e=>c(e.target.value),disabled:!t})]}),(0,a.jsxs)("label",{className:"block space-y-2",children:[(0,a.jsx)("span",{className:"text-sm text-slate-600",children:"Content"}),(0,a.jsx)("textarea",{value:u,onChange:e=>d(e.target.value),placeholder:"Paste or type content… (blank lines = new paragraph)",className:"min-h-[200px] w-full rounded border border-slate-300 px-3 py-2 outline-none focus:border-slate-500",disabled:!t})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(e=>(0,a.jsx)("button",{...e,className:["inline-flex items-center justify-center rounded-full px-4 py-2","border border-black bg-black text-white","hover:bg-black/90 active:scale-[0.99] transition","disabled:opacity-50 disabled:cursor-not-allowed",e.className||""].join(" ")}),{onClick:y,disabled:!t||m,children:m?"Creating…":"Create document"}),p&&(0,a.jsx)("span",{className:"text-sm text-slate-600",children:p}),x&&(0,a.jsx)("span",{className:"text-sm text-rose-600",children:x})]})]})}}},function(e){e.O(0,[439,971,117,744],function(){return e(e.s=6465)}),_N_E=e.O()}]);