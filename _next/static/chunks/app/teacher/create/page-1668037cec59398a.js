(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[696],{6465:function(e,t,a){Promise.resolve().then(a.bind(a,4985))},4985:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return r}});var s=a(7437),n=a(2265),i=a(5526);let l="/english-highlighter-guest-ca";function r(){let[e,t]=(0,n.useState)(null),[a,r]=(0,n.useState)(""),[c,d]=(0,n.useState)("student"),[o,u]=(0,n.useState)(""),[m,h]=(0,n.useState)(""),[x,p]=(0,n.useState)(!1),[g,f]=(0,n.useState)(null),[b,v]=(0,n.useState)(null),[N,j]=(0,n.useState)("");async function y(){var t;(null==e?void 0:e.user)&&(await i.O.from("profiles").upsert({id:e.user.id,full_name:a.trim()||(null!==(t=e.user.email)&&void 0!==t?t:"Guest"),role:c}),j("Saved"),setTimeout(()=>j(""),1200))}async function w(t){var s,n,l;if(t.preventDefault(),!(null==e?void 0:e.user)){j("Please sign in first.");return}if(!o.trim()||!m.trim()){j("Title and content required.");return}p(!0);try{await i.O.from("profiles").upsert({id:e.user.id,full_name:a.trim()||(null!==(s=e.user.email)&&void 0!==s?s:"Guest"),role:c});let{data:t,error:l}=await i.O.from("documents").insert({title:o,content:m,created_by:e.user.id}).select("id, short_code").maybeSingle();if(l||!t)throw null!=l?l:Error("Insert failed");f(t.id);let r=null!==(n=t.short_code)&&void 0!==n?n:t.id.slice(0,8);v(r);try{await navigator.clipboard.writeText(r)}catch(e){}let d=m.split(/\n\s*\n+/).map(e=>e.trim()).filter(Boolean);if(d.length){let e=d.map((e,a)=>({document_id:t.id,idx:a,text:e})),{error:a}=await i.O.from("paragraphs").insert(e);if(a)throw a}}catch(e){j(null!==(l=e.message)&&void 0!==l?l:String(e))}finally{p(!1)}}return(0,n.useEffect)(()=>{let e=i.O.auth.onAuthStateChange((e,a)=>t(a)).data;return(async()=>{let e=(await i.O.auth.getSession()).data.session;e?t(e):await i.O.auth.signInAnonymously()})(),()=>e.subscription.unsubscribe()},[]),(0,s.jsxs)("main",{className:"container py-10 space-y-8",children:[(0,s.jsx)("h1",{className:"text-2xl font-semibold",children:"Create a Document"}),(0,s.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{className:"card space-y-3",children:[(0,s.jsx)("div",{className:"text-sm font-medium",children:"Your display name (shown to class)"}),(0,s.jsx)("input",{className:"input",placeholder:"e.g., Ying",value:a,onChange:e=>r(e.target.value)}),(0,s.jsx)("button",{className:"btn w-max",onClick:y,children:"Save name"}),N&&(0,s.jsx)("div",{className:"text-xs text-gray-600",children:N})]}),(0,s.jsxs)("div",{className:"card space-y-3",children:[(0,s.jsx)("div",{className:"text-sm font-medium",children:"Your role"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{type:"button",className:"btn border-gray-300 ".concat("student"===c?"bg-gray-900 text-white":"text-gray-900"),onClick:()=>d("student"),children:"Student"}),(0,s.jsx)("button",{type:"button",className:"btn border-gray-300 ".concat("teacher"===c?"bg-gray-900 text-white":"text-gray-900"),onClick:()=>d("teacher"),children:"Teacher"})]}),(0,s.jsx)("div",{className:"text-xs text-gray-600",children:"This sets your profile role. Document ownership is based on who creates it."})]})]}),(0,s.jsxs)("form",{onSubmit:w,className:"card max-w-2xl space-y-4",children:[(0,s.jsxs)("label",{className:"block",children:[(0,s.jsx)("div",{className:"text-sm font-medium",children:"Title"}),(0,s.jsx)("input",{className:"input mt-1",value:o,onChange:e=>u(e.target.value),placeholder:"e.g., A great summer vacation"})]}),(0,s.jsxs)("label",{className:"block",children:[(0,s.jsx)("div",{className:"text-sm font-medium",children:"Content (blank line = new paragraph)"}),(0,s.jsx)("textarea",{className:"input mt-1",rows:12,value:m,onChange:e=>h(e.target.value),placeholder:"Paragraph 1...\n\nParagraph 2..."})]}),(0,s.jsx)("button",{className:"btn",disabled:x,type:"submit",children:x?"Creating…":"Create document"})]}),g&&(0,s.jsxs)("div",{className:"card max-w-3xl",children:[(0,s.jsx)("div",{className:"text-green-700 text-sm",children:"✅ Document created."}),(0,s.jsxs)("div",{className:"grid md:grid-cols-2 gap-4 mt-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-xs text-gray-500",children:"Document ID"}),(0,s.jsxs)("div",{className:"flex gap-2 mt-1",children:[(0,s.jsx)("code",{className:"input",children:g}),(0,s.jsx)("button",{className:"btn",onClick:()=>navigator.clipboard.writeText(g),children:"Copy"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-xs text-gray-500",children:"Short Code"}),(0,s.jsxs)("div",{className:"flex gap-2 mt-1",children:[(0,s.jsx)("code",{className:"input",children:b}),(0,s.jsx)("button",{className:"btn",onClick:()=>navigator.clipboard.writeText(null!=b?b:""),children:"Copy"})]}),(0,s.jsx)("div",{className:"text-[11px] text-gray-500 mt-1",children:"Tip: Short Code was copied automatically."})]})]}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-3 mt-4",children:[(0,s.jsx)("a",{className:"btn",href:b?"".concat(l,"/s.html?code=").concat(b):"#",children:"Open Student View"}),(0,s.jsx)("a",{className:"btn",href:b?"".concat(l,"/t.html?code=").concat(b):"#",children:"Open Teacher View"})]})]})]})}},5526:function(e,t,a){"use strict";a.d(t,{O:function(){return s}});let s=(0,a(8439).eI)("https://jjbsscygzuomnsfpzzex.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpqYnNzY3lnenVvbW5zZnB6emV4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYwMzQzMDksImV4cCI6MjA3MTYxMDMwOX0.kd3D0KsN0iekbJ9uPTEuQ0BTxAvopleychGiQ99ytsk")}},function(e){e.O(0,[439,971,117,744],function(){return e(e.s=6465)}),_N_E=e.O()}]);