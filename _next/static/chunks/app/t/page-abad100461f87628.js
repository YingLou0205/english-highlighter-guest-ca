(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[708],{3465:function(e,t,s){Promise.resolve().then(s.bind(s,8364))},8364:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return c}});var a=s(7437),l=s(2265),n=s(8439);function r(e){return"hsl(48 100% ".concat(92-Math.round(32*Math.max(0,Math.min(1,e))),"%)")}function c(){let e=l.useMemo(()=>(0,n.eI)("https://jjbsscygzuomnsfpzzex.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpqYnNzY3lnenVvbW5zZnB6emV4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYwMzQzMDksImV4cCI6MjA3MTYxMDMwOX0.kd3D0KsN0iekbJ9uPTEuQ0BTxAvopleychGiQ99ytsk"),[]),[t,s]=l.useState([]),[c,i]=l.useState(null),[o,d]=l.useState([]),[m,x]=l.useState(!1),[h,u]=l.useState(null);l.useEffect(()=>{(async()=>{let{data:t}=await e.from("documents").select("id, title").order("created_at",{ascending:!1}).limit(100);t&&(s(t),t.length&&!c&&i(t[0].id))})()},[]),l.useEffect(()=>{let t=!1;if(c)return(async()=>{try{x(!0),u(null);let{data:s,error:a}=await e.from("highlights").select("id, document_id, paragraph_id, user_id, start_offset, end_offset, text, kind, created_at").eq("document_id",c);if(a)throw a;t||d(s||[])}catch(e){var s;t||u(null!==(s=null==e?void 0:e.message)&&void 0!==s?s:"Failed to load highlights")}finally{t||x(!1)}})(),()=>{t=!0}},[c,e]);let f=l.useMemo(()=>{let e=new Map;for(let t of o)"word"===t.kind&&e.set(t.text,(e.get(t.text)||0)+1);let t=Array.from(e.entries()).map(e=>{let[t,s]=e;return{text:t,freq:s}});return t.sort((e,t)=>t.freq-e.freq),t},[o]),p=l.useMemo(()=>{let e=new Map;for(let t of o)"sentence"===t.kind&&e.set(t.text,(e.get(t.text)||0)+1);let t=Array.from(e.entries()).map(e=>{let[t,s]=e;return{text:t,freq:s}});return t.sort((e,t)=>t.freq-e.freq),t},[o]),g=l.useMemo(()=>{let e=new Map;for(let t of o){if("span"!==t.kind)continue;let s="".concat(t.text,"::").concat(t.start_offset,"::").concat(t.end_offset),a=e.get(s);a?a.freq+=1:e.set(s,{text:t.text,start:t.start_offset,end:t.end_offset,freq:1})}let t=Array.from(e.values());return t.sort((e,t)=>t.freq-e.freq),t},[o]),N=l.useMemo(()=>f.reduce((e,t)=>Math.max(e,t.freq),1),[f]),j=l.useMemo(()=>p.reduce((e,t)=>Math.max(e,t.freq),1),[p]),y=l.useMemo(()=>g.reduce((e,t)=>Math.max(e,t.freq),1),[g]);return(0,a.jsxs)("main",{className:"mx-auto max-w-6xl p-6 space-y-6",children:[(0,a.jsxs)("header",{className:"flex flex-wrap items-center gap-3",children:[(0,a.jsx)("h1",{className:"text-2xl font-semibold",children:"Teacher"}),(0,a.jsxs)("div",{className:"ml-auto flex items-center gap-2",children:[(0,a.jsx)("label",{className:"text-sm text-slate-600",children:"Document"}),(0,a.jsx)("select",{value:null!=c?c:"",onChange:e=>i(e.target.value||null),className:"rounded border border-slate-300 bg-white px-3 py-2 text-sm outline-none focus:border-slate-500",children:t.map(e=>(0,a.jsx)("option",{value:e.id,children:e.title||e.id},e.id))})]})]}),h&&(0,a.jsx)("div",{className:"rounded border border-rose-200 bg-rose-50 px-3 py-2 text-rose-800",children:h}),m&&(0,a.jsx)("div",{className:"text-slate-500",children:"Loading…"}),(0,a.jsxs)("section",{className:"space-y-3",children:[(0,a.jsx)("h2",{className:"text-lg font-medium",children:"Heatmap — Sentences"}),p.length?(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:p.slice(0,150).map((e,t)=>(0,a.jsx)("span",{className:"select-none text-slate-900 rounded px-1",style:{backgroundColor:r(e.freq/j),lineHeight:1.1,fontSize:12+Math.round(e.freq/j*6)},title:"\xd7".concat(e.freq),children:e.text},"sent-".concat(t)))}):(0,a.jsx)("div",{className:"text-sm text-slate-500",children:"No sentence highlights yet."})]}),(0,a.jsxs)("section",{className:"space-y-3",children:[(0,a.jsx)("h2",{className:"text-lg font-medium",children:"Heatmap — Words"}),f.length?(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:f.slice(0,200).map((e,t)=>(0,a.jsx)("span",{className:"select-none text-slate-900 rounded px-1",style:{backgroundColor:r(e.freq/N),lineHeight:1.1,fontSize:12+Math.round(e.freq/N*10)},title:"\xd7".concat(e.freq),children:e.text},"word-".concat(t)))}):(0,a.jsx)("div",{className:"text-sm text-slate-500",children:"No word highlights yet."})]}),(0,a.jsxs)("section",{className:"space-y-2",children:[(0,a.jsx)("h2",{className:"text-lg font-medium",children:"Top Sentences (all highlights)"}),p.length?(0,a.jsx)("ol",{className:"space-y-2",children:p.slice(0,50).map((e,t)=>(0,a.jsxs)("li",{className:"rounded border border-slate-200 bg-white p-3",children:[(0,a.jsxs)("div",{className:"text-sm text-slate-500",children:["#",t+1," • \xd7",e.freq]}),(0,a.jsx)("div",{className:"mt-1",children:e.text||(0,a.jsx)("em",{className:"text-slate-500",children:"(no text)"})})]},"tops-".concat(t)))}):(0,a.jsx)("div",{className:"text-sm text-slate-500",children:"No sentence highlights yet."})]}),(0,a.jsxs)("section",{className:"space-y-2",children:[(0,a.jsx)("h2",{className:"text-lg font-medium",children:"Top Spans (all highlights)"}),g.length?(0,a.jsx)("ol",{className:"space-y-2",children:g.slice(0,50).map((e,t)=>(0,a.jsxs)("li",{className:"rounded border border-slate-200 bg-white p-3",children:[(0,a.jsxs)("div",{className:"text-sm text-slate-500",children:["#",t+1," • \xd7",e.freq]}),(0,a.jsxs)("div",{className:"mt-1",children:[(0,a.jsx)("span",{className:"rounded px-1",style:{backgroundColor:r(e.freq/y)},children:e.text}),(0,a.jsxs)("span",{className:"ml-2 text-xs text-slate-500",children:["[",e.start,"-",e.end,"]"]})]})]},"topsp-".concat(t)))}):(0,a.jsx)("div",{className:"text-sm text-slate-500",children:"No span highlights yet."})]})]})}}},function(e){e.O(0,[439,971,117,744],function(){return e(e.s=3465)}),_N_E=e.O()}]);