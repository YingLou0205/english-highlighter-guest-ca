(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[905],{5767:function(e,l,t){Promise.resolve().then(t.bind(t,5759))},5759:function(e,l,t){"use strict";t.r(l),t.d(l,{default:function(){return a}});var s=t(7437),n=t(2265),i=t(8439);function a(){let e=n.useMemo(()=>(function(){let e="https://jjbsscygzuomnsfpzzex.supabase.co",l="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpqYnNzY3lnenVvbW5zZnB6emV4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYwMzQzMDksImV4cCI6MjA3MTYxMDMwOX0.kd3D0KsN0iekbJ9uPTEuQ0BTxAvopleychGiQ99ytsk";if(!e||!l)throw Error("Missing NEXT_PUBLIC_SUPABASE_URL or NEXT_PUBLIC_SUPABASE_ANON_KEY");return(0,i.eI)(e,l)})(),[]),[l,t]=n.useState(!1),[a,r]=n.useState(null),[u,o]=n.useState(""),[c,d]=n.useState(!1),[f,m]=n.useState(null),[p,b]=n.useState(null);n.useEffect(()=>{let l=!1;return(async()=>{var s,n;try{b(null);let t=(await e.auth.getSession()).data.session;if(!t){let{data:l,error:n}=await e.auth.signInAnonymously();if(n)throw n;t=null!==(s=l.session)&&void 0!==s?s:null}let n=null==t?void 0:t.user;if(!n)throw Error("Unable to establish a session");if(l)return;r(n.id);let{data:i,error:a}=await e.from("profiles").select("id, full_name").eq("id",n.id).maybeSingle();!a&&(null==i?void 0:i.full_name)&&o(i.full_name),(null==a?void 0:a.code)!=="PGRST116"&&i||await e.from("profiles").upsert({id:n.id,full_name:null})}catch(e){b(null!==(n=null==e?void 0:e.message)&&void 0!==n?n:"Failed to initialize.")}finally{l||t(!0)}})(),()=>{l=!0}},[e]);let h=async()=>{if(a){d(!0),m(null),b(null);try{let l=u.trim()||"Guest",{error:t}=await e.from("profiles").upsert({id:a,full_name:l});if(t)throw t;m("Saved ✓")}catch(e){var l;b(null!==(l=null==e?void 0:e.message)&&void 0!==l?l:"Save failed")}finally{d(!1)}}};return(0,s.jsxs)("main",{className:"mx-auto max-w-2xl p-6 space-y-4",children:[(0,s.jsx)("h1",{className:"text-2xl font-semibold",children:"Student"}),(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,s.jsx)("input",{className:"min-w-[220px] rounded border border-slate-300 px-3 py-2 outline-none focus:border-slate-500",placeholder:"Your name",value:u,onChange:e=>o(e.target.value),disabled:!l}),(0,s.jsx)("button",{type:"button",onClick:h,disabled:!a||c||!l,className:"inline-flex items-center justify-center rounded-full px-4 py-2 border border-black bg-black text-white disabled:opacity-50 disabled:cursor-not-allowed hover:bg-black/90 active:scale-[0.99] transition",children:c?"Saving…":"Save"}),f&&(0,s.jsx)("span",{className:"text-sm text-slate-600",children:f}),p&&(0,s.jsx)("span",{className:"text-sm text-rose-600",children:p})]})]})}}},function(e){e.O(0,[439,971,117,744],function(){return e(e.s=5767)}),_N_E=e.O()}]);