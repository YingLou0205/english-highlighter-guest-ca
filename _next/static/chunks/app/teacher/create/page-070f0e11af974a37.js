(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[696],{6465:function(e,t,a){Promise.resolve().then(a.bind(a,4985))},4985:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return c}});var n,s=a(7437),l=a(2265),r=a(5526);let i=null!==(n=a(257).env.NEXT_PUBLIC_BASE_PATH)&&void 0!==n?n:"";function c(){let[e,t]=(0,l.useState)(""),[a,n]=(0,l.useState)(""),[c,o]=(0,l.useState)(!1),[d,u]=(0,l.useState)(""),[m,p]=(0,l.useState)(""),[x,h]=(0,l.useState)(!1),[f,b]=(0,l.useState)(null),[g,v]=(0,l.useState)(null),[y,N]=(0,l.useState)("");async function j(){if(e){o(!0);try{await r.O.from("profiles").upsert({id:e,full_name:a.trim()||"Teacher"})}finally{o(!1)}}}async function w(t){t.preventDefault(),N(""),h(!0);try{let t=m.replace(/\r\n/g,"\n").split(/\n\s*\n/g).map(e=>e.trim()).filter(Boolean);if(!d.trim()||0===t.length){N("Please provide a title and some content."),h(!1);return}if(!e){N("Please sign in before creating a document."),h(!1);return}let a=await r.O.from("documents").insert({title:d.trim(),content:m,created_by:e}).select("id,short_code").single();if(a.error)throw a.error;let n=a.data.id;b(n),v(a.data.short_code);let s=t.map((e,t)=>({document_id:n,text:e,idx:t})),l=await r.O.from("paragraphs").insert(s);if(l.error)throw l.error}catch(e){var a;console.error(e),N(null!==(a=e.message)&&void 0!==a?a:"Failed to create document.")}finally{h(!1)}}(0,l.useEffect)(()=>{(async()=>{var e;let{data:a}=await r.O.auth.getUser(),s=(null===(e=a.user)||void 0===e?void 0:e.id)||"";if(t(s),s){let{data:e}=await r.O.from("profiles").select("full_name").eq("id",s).single();(null==e?void 0:e.full_name)&&n(e.full_name)}})()},[]);let k=(0,l.useMemo)(()=>g?"".concat(i,"/s?code=").concat(g):"#",[g]),C=(0,l.useMemo)(()=>g?"".concat(i,"/t?code=").concat(g):"#",[g]);return(0,s.jsxs)("main",{className:"max-w-3xl mx-auto px-4 py-6",children:[(0,s.jsx)("h1",{className:"text-xl font-semibold mb-4",children:"Create Document"}),(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-6",children:[(0,s.jsx)("input",{className:"border rounded-md px-3 py-2 text-sm",value:a,onChange:e=>n(e.target.value),placeholder:"Your name (for profile)"}),(0,s.jsx)("button",{type:"button",className:"px-3 py-2 rounded-md bg-black text-white hover:bg-neutral-900 disabled:opacity-50",onClick:j,disabled:!e||c,children:c?"Saving…":"Save name"})]}),(0,s.jsxs)("form",{onSubmit:w,className:"space-y-3",children:[(0,s.jsx)("input",{className:"w-full border rounded-md px-3 py-2",placeholder:"Title",value:d,onChange:e=>u(e.target.value)}),(0,s.jsx)("textarea",{className:"w-full border rounded-md px-3 py-2 h-64",placeholder:"Paste the text for your students here. Blank lines start a new paragraph.",value:m,onChange:e=>p(e.target.value)}),y&&(0,s.jsx)("div",{className:"text-red-600",children:y}),(0,s.jsx)("button",{className:"px-4 py-2 rounded-md bg-black text-white hover:bg-neutral-900 disabled:opacity-50",disabled:x,type:"submit",children:x?"Creating…":"Create document"})]}),f&&(0,s.jsxs)("div",{className:"mt-8 space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"text-sm text-gray-600",children:"Document ID:"}),(0,s.jsx)("div",{className:"font-mono text-sm",children:f}),(0,s.jsx)("button",{type:"button",className:"px-2 py-1 rounded-md bg-black text-white hover:bg-neutral-900",onClick:()=>navigator.clipboard.writeText(f),children:"Copy"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"text-sm text-gray-600",children:"Code:"}),(0,s.jsx)("div",{className:"font-mono text-sm",children:g}),(0,s.jsx)("button",{type:"button",className:"px-2 py-1 rounded-md bg-black text-white hover:bg-neutral-900",onClick:()=>navigator.clipboard.writeText(null!=g?g:""),children:"Copy"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3 pt-2",children:[(0,s.jsx)("a",{className:"px-3 py-2 rounded-md bg-black text-white hover:bg-neutral-900",href:k,children:"Open Student View"}),(0,s.jsx)("a",{className:"px-3 py-2 rounded-md bg-black text-white hover:bg-neutral-900",href:C,children:"Open Teacher View"})]})]})]})}},5526:function(e,t,a){"use strict";a.d(t,{O:function(){return n}});let n=(0,a(8439).eI)("https://jjbsscygzuomnsfpzzex.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpqYnNzY3lnenVvbW5zZnB6emV4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYwMzQzMDksImV4cCI6MjA3MTYxMDMwOX0.kd3D0KsN0iekbJ9uPTEuQ0BTxAvopleychGiQ99ytsk")}},function(e){e.O(0,[439,971,117,744],function(){return e(e.s=6465)}),_N_E=e.O()}]);